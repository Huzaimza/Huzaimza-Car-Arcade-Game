/* Reset and Base Styles */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Arial', sans-serif;
    background: linear-gradient(135deg, #1e3c72, #2a5298);
    overflow: hidden;
    height: 100vh;
    user-select: none;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
}

/* Game Container */
.game-container {
    position: relative;
    width: 100vw;
    height: 100vh;
    perspective: 1000px;
    overflow: hidden;
}

/* Game World - 3D Scene */
.game-world {
    position: absolute;
    width: 100%;
    height: 100%;
    transform-style: preserve-3d;
    perspective: 800px;
    perspective-origin: 50% 30%;
    background: 
        radial-gradient(ellipse at center top, #87CEEB 0%, #4682B4 50%, #2F4F4F 100%),
        linear-gradient(to bottom, transparent 0%, transparent 40%, rgba(152, 251, 152, 0.3) 40%, rgba(34, 139, 34, 0.8) 100%);
    overflow: hidden;
}

/* 3D Environment Elements */
.game-world::before {
    content: '';
    position: absolute;
    top: 0;
    left: -20%;
    right: -20%;
    height: 40%;
    background: 
        repeating-linear-gradient(
            90deg,
            transparent 0px,
            transparent 80px,
            rgba(100,100,100,0.1) 80px,
            rgba(100,100,100,0.1) 85px,
            rgba(150,150,150,0.2) 85px,
            rgba(150,150,150,0.2) 90px,
            rgba(100,100,100,0.1) 90px,
            rgba(100,100,100,0.1) 95px,
            transparent 95px,
            transparent 160px
        );
    transform: rotateX(90deg) translateZ(-200px);
    pointer-events: none;
    z-index: 1;
}

.game-world::after {
    content: '';
    position: absolute;
    top: 0;
    right: -20%;
    left: -20%;
    height: 40%;
    background: 
        repeating-linear-gradient(
            90deg,
            transparent 0px,
            transparent 100px,
            rgba(80,80,80,0.15) 100px,
            rgba(80,80,80,0.15) 110px,
            rgba(120,120,120,0.25) 110px,
            rgba(120,120,120,0.25) 120px,
            rgba(80,80,80,0.15) 120px,
            rgba(80,80,80,0.15) 130px,
            transparent 130px,
            transparent 200px
        );
    transform: rotateX(90deg) translateZ(-300px);
    pointer-events: none;
    z-index: 0;
}

/* Road Styling */
.road {
    position: absolute;
    width: 100%;
    height: 100%;
    transform-style: preserve-3d;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%) rotateX(85deg) translateZ(-100px);
}

.road-segment {
    position: absolute;
    width: 400px;
    height: 300px;
    left: 50%;
    top: 50%;
    margin-left: -200px;
    margin-top: -150px;
    background: 
        repeating-linear-gradient(
            90deg,
            #2a2a2a 0px,
            #2a2a2a 8px,
            #404040 8px,
            #404040 16px,
            #2a2a2a 16px,
            #2a2a2a 24px,
            #404040 24px,
            #404040 32px
        ),
        linear-gradient(
            to right,
            #1a1a1a 0%,
            #333 20%,
            #555 45%,
            #fff 48%,
            #fff 52%,
            #555 55%,
            #333 80%,
            #1a1a1a 100%
        );
    border: 3px solid #111;
    box-shadow: 
        0 0 50px rgba(0,0,0,0.8),
        inset 0 0 30px rgba(0,0,0,0.5);
    animation: roadMove 0.1s linear infinite;
    transform-style: preserve-3d;
}

@keyframes roadMove {
    0% { transform: translateZ(0px); }
    100% { transform: translateZ(200px); }
}

/* Player Car */
.player-car {
    position: absolute;
    width: 70px;
    height: 140px;
    bottom: 15%;
    left: 50%;
    transform: translateX(-50%) translateZ(0px);
    transform-style: preserve-3d;
    z-index: 100;
    transition: transform 0.15s ease-out;
}

.car-body {
    position: absolute;
    width: 100%;
    height: 100%;
    background: 
        linear-gradient(145deg, #ff6b6b, #ff5252),
        radial-gradient(ellipse at 30% 30%, rgba(255,255,255,0.4), transparent 60%);
    border-radius: 45% 45% 15% 15%;
    box-shadow: 
        0 10px 25px rgba(0,0,0,0.5),
        0 5px 10px rgba(0,0,0,0.3),
        inset 0 3px 8px rgba(255,255,255,0.3),
        inset 0 -3px 8px rgba(0,0,0,0.2);
    border: 2px solid #d32f2f;
    transform: translateZ(5px);
}

.car-body::before {
    content: '';
    position: absolute;
    top: 10%;
    left: 10%;
    right: 10%;
    height: 25%;
    background: linear-gradient(135deg, rgba(255,255,255,0.3), transparent);
    border-radius: 50% 50% 20% 20%;
    transform: translateZ(1px);
}

.car-windshield {
    position: absolute;
    width: 75%;
    height: 45%;
    top: 12%;
    left: 12.5%;
    background: 
        linear-gradient(145deg, rgba(135, 206, 235, 0.9), rgba(100, 149, 237, 0.95)),
        radial-gradient(ellipse at 70% 30%, rgba(255,255,255,0.4), transparent 50%);
    border-radius: 25px 25px 8px 8px;
    border: 2px solid rgba(255,255,255,0.6);
    box-shadow: 
        inset 0 2px 5px rgba(255,255,255,0.5),
        0 2px 10px rgba(0,0,0,0.3);
    transform: translateZ(8px);
}

.car-windshield::after {
    content: '';
    position: absolute;
    top: 20%;
    left: 70%;
    width: 25%;
    height: 40%;
    background: linear-gradient(135deg, rgba(255,255,255,0.6), transparent);
    border-radius: 50%;
    filter: blur(1px);
}

.car-wheel {
    position: absolute;
    width: 16px;
    height: 16px;
    background: 
        radial-gradient(circle at 30% 30%, #555 20%, #222 40%, #111 60%, #000 80%),
        conic-gradient(from 0deg, #333, #555, #333, #555, #333);
    border-radius: 50%;
    border: 2px solid #000;
    box-shadow: 
        0 3px 8px rgba(0,0,0,0.6),
        inset 0 1px 3px rgba(255,255,255,0.3);
    transform: translateZ(3px);
}

.car-wheel::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 6px;
    height: 6px;
    background: radial-gradient(circle, #888, #333);
    border-radius: 50%;
    transform: translate(-50%, -50%);
    border: 1px solid #555;
}

.wheel-fl { top: 18%; left: -4px; }
.wheel-fr { top: 18%; right: -4px; }
.wheel-bl { bottom: 18%; left: -4px; }
.wheel-br { bottom: 18%; right: -4px; }

/* Obstacles */
.obstacle {
    position: absolute;
    transform-style: preserve-3d;
    z-index: 50;
}

.obstacle-car {
    width: 55px;
    height: 110px;
    background: 
        linear-gradient(145deg, #2196F3, #1976D2),
        radial-gradient(ellipse at 30% 30%, rgba(255,255,255,0.3), transparent 60%);
    border-radius: 35% 35% 12% 12%;
    border: 2px solid #0D47A1;
    box-shadow: 
        0 8px 20px rgba(0,0,0,0.5),
        0 4px 10px rgba(0,0,0,0.3),
        inset 0 2px 5px rgba(255,255,255,0.2);
    transform: translateZ(2px);
    position: relative;
}

.obstacle-car::before {
    content: '';
    position: absolute;
    top: 15%;
    left: 15%;
    right: 15%;
    height: 35%;
    background: linear-gradient(145deg, rgba(135, 206, 235, 0.8), rgba(100, 149, 237, 0.9));
    border-radius: 20px 20px 5px 5px;
    border: 1px solid rgba(255,255,255,0.5);
    transform: translateZ(2px);
}

.obstacle-truck {
    width: 65px;
    height: 150px;
    background: 
        linear-gradient(145deg, #4CAF50, #388E3C),
        radial-gradient(ellipse at 25% 25%, rgba(255,255,255,0.3), transparent 50%);
    border-radius: 12%;
    border: 3px solid #1B5E20;
    box-shadow: 
        0 10px 25px rgba(0,0,0,0.6),
        0 5px 15px rgba(0,0,0,0.4),
        inset 0 3px 8px rgba(255,255,255,0.2);
    transform: translateZ(3px);
    position: relative;
}

.obstacle-truck::before {
    content: '';
    position: absolute;
    top: 10%;
    left: 10%;
    right: 10%;
    height: 30%;
    background: linear-gradient(145deg, rgba(255,255,255,0.3), rgba(200,200,200,0.2));
    border-radius: 15px 15px 8px 8px;
    border: 1px solid rgba(255,255,255,0.4);
    transform: translateZ(2px);
}

.obstacle-cone {
    width: 35px;
    height: 35px;
    background: 
        linear-gradient(145deg, #FF9800, #F57C00),
        radial-gradient(circle at 30% 30%, rgba(255,255,255,0.4), transparent 60%);
    border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
    border: 2px solid #E65100;
    box-shadow: 
        0 5px 15px rgba(0,0,0,0.4),
        0 2px 8px rgba(0,0,0,0.3),
        inset 0 2px 4px rgba(255,255,255,0.3);
    transform: translateZ(1px);
    position: relative;
}

.obstacle-cone::before {
    content: '';
    position: absolute;
    top: 20%;
    left: 20%;
    right: 20%;
    height: 15%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.8), transparent);
    border-radius: 50%;
    transform: translateZ(1px);
}

/* Particle Effects */
.particles {
    position: absolute;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 10;
    transform-style: preserve-3d;
}

.particle {
    position: absolute;
    width: 6px;
    height: 6px;
    background: 
        radial-gradient(circle, rgba(255,255,255,1) 0%, rgba(255,255,255,0.8) 50%, transparent 100%);
    border-radius: 50%;
    animation: particleMove 1s linear infinite;
    box-shadow: 0 0 8px rgba(255,255,255,0.6);
    transform-style: preserve-3d;
}

@keyframes particleMove {
    0% {
        transform: translateY(0) translateZ(0) scale(1);
        opacity: 1;
    }
    100% {
        transform: translateY(100vh) translateZ(50px) scale(0.3);
        opacity: 0;
    }
}

/* UI Elements */
.game-ui {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 1000;
}

.score-panel {
    position: absolute;
    top: 20px;
    left: 20px;
    background: rgba(0,0,0,0.7);
    color: white;
    padding: 15px;
    border-radius: 10px;
    font-weight: bold;
    pointer-events: auto;
    backdrop-filter: blur(10px);
}

.score-panel div {
    margin-bottom: 5px;
}

.score-panel div:last-child {
    margin-bottom: 0;
}

/* Game Screens */
.start-screen, .game-over-screen {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: rgba(0,0,0,0.9);
    color: white;
    padding: 40px;
    border-radius: 20px;
    text-align: center;
    pointer-events: auto;
    backdrop-filter: blur(20px);
    border: 2px solid rgba(255,255,255,0.2);
}

.start-screen h1 {
    font-size: 2.5em;
    margin-bottom: 20px;
    color: #ff6b6b;
    text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
}

.game-over-screen h2 {
    font-size: 2em;
    margin-bottom: 20px;
    color: #ff6b6b;
}

.start-screen p, .game-over-screen p {
    margin-bottom: 15px;
    font-size: 1.1em;
}

button {
    background: linear-gradient(145deg, #ff6b6b, #ff5252);
    color: white;
    border: none;
    padding: 15px 30px;
    font-size: 1.2em;
    border-radius: 10px;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 4px 15px rgba(0,0,0,0.3);
}

button:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(0,0,0,0.4);
    background: linear-gradient(145deg, #ff5252, #f44336);
}

button:active {
    transform: translateY(0);
}

/* Mobile Controls */
.mobile-controls {
    position: absolute;
    bottom: 20px;
    left: 0;
    right: 0;
    display: flex;
    justify-content: space-between;
    align-items: flex-end;
    padding: 0 20px;
    pointer-events: auto;
    z-index: 1001;
}

.control-left, .control-right {
    display: flex;
    flex-direction: column;
}

.control-center {
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.control-btn {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background: rgba(0,0,0,0.7);
    color: white;
    border: 2px solid rgba(255,255,255,0.3);
    font-size: 1.5em;
    display: flex;
    align-items: center;
    justify-content: center;
    backdrop-filter: blur(10px);
    transition: all 0.2s ease;
    user-select: none;
    -webkit-user-select: none;
    -webkit-touch-callout: none;
    -webkit-tap-highlight-color: transparent;
}

.control-btn:active {
    background: rgba(255,255,255,0.3);
    transform: scale(0.95);
}

.control-btn span {
    pointer-events: none;
}

/* Hidden elements */
.hidden {
    display: none !important;
}

/* Responsive Design */
@media (max-width: 768px) {
    .score-panel {
        top: 10px;
        left: 10px;
        padding: 10px;
        font-size: 0.9em;
    }
    
    .start-screen, .game-over-screen {
        padding: 30px 20px;
        margin: 0 20px;
        max-width: calc(100vw - 40px);
    }
    
    .start-screen h1 {
        font-size: 2em;
    }
    
    .game-over-screen h2 {
        font-size: 1.5em;
    }
    
    .player-car {
        width: 50px;
        height: 100px;
    }
    
    .road-segment {
        width: 250px;
        margin-left: -125px;
    }
}

@media (max-width: 480px) {
    .score-panel {
        font-size: 0.8em;
        padding: 8px;
    }
    
    .mobile-controls {
        bottom: 10px;
        padding: 0 10px;
    }
    
    .control-btn {
        width: 50px;
        height: 50px;
        font-size: 1.2em;
    }
    
    .player-car {
        width: 45px;
        height: 90px;
    }
    
    .road-segment {
        width: 200px;
        margin-left: -100px;
    }
}

/* Landscape mobile optimization */
@media (max-height: 500px) and (orientation: landscape) {
    .score-panel {
        top: 5px;
        left: 5px;
        padding: 5px;
        font-size: 0.7em;
    }
    
    .mobile-controls {
        bottom: 5px;
    }
    
    .control-btn {
        width: 45px;
        height: 45px;
        font-size: 1em;
    }
    
    .start-screen, .game-over-screen {
        padding: 20px;
        margin: 0 10px;
    }
    
    .start-screen h1 {
        font-size: 1.5em;
        margin-bottom: 10px;
    }
    
    .game-over-screen h2 {
        font-size: 1.2em;
        margin-bottom: 10px;
    }
}

/* Desktop-specific styles */
@media (min-width: 1024px) {
    .mobile-controls {
        display: none;
    }
    
    .player-car {
        width: 70px;
        height: 130px;
    }
    
    .road-segment {
        width: 400px;
        margin-left: -200px;
    }
}

/* Animation for car movement */
.car-turning-left {
    transform: translateX(-50%) translateZ(0px) rotateZ(-8deg) rotateY(-3deg) !important;
}

.car-turning-right {
    transform: translateX(-50%) translateZ(0px) rotateZ(8deg) rotateY(3deg) !important;
}

.car-boost {
    animation: carBoost 0.3s ease-out;
}

@keyframes carBoost {
    0% { 
        transform: translateX(-50%) translateZ(0px) scale(1); 
        filter: brightness(1);
    }
    50% { 
        transform: translateX(-50%) translateZ(-5px) scale(1.05); 
        filter: brightness(1.2) drop-shadow(0 0 15px rgba(255,107,107,0.8));
    }
    100% { 
        transform: translateX(-50%) translateZ(0px) scale(1); 
        filter: brightness(1);
    }
}

/* Engine/exhaust effects */
.exhaust-particle {
    position: absolute;
    width: 8px;
    height: 8px;
    background: 
        radial-gradient(circle, rgba(120,120,120,0.9) 0%, rgba(80,80,80,0.7) 50%, transparent 100%);
    border-radius: 50%;
    animation: exhaustMove 0.6s ease-out infinite;
    box-shadow: 0 0 6px rgba(100,100,100,0.4);
    transform-style: preserve-3d;
}

@keyframes exhaustMove {
    0% {
        transform: translateY(0) translateZ(0) scale(1);
        opacity: 0.8;
        filter: blur(0px);
    }
    50% {
        transform: translateY(25px) translateZ(10px) scale(1.2);
        opacity: 0.4;
        filter: blur(1px);
    }
    100% {
        transform: translateY(60px) translateZ(20px) scale(0.3);
        opacity: 0;
        filter: blur(2px);
    }
}

/* ==============================================
   3D ENVIRONMENT ENHANCEMENTS
   ============================================== */

/* Environment Container */
.environment {
    position: absolute;
    width: 100%;
    height: 100%;
    transform-style: preserve-3d;
    pointer-events: none;
    z-index: 1;
}

/* Clouds */
.clouds {
    position: absolute;
    width: 100%;
    height: 100%;
    transform-style: preserve-3d;
}

.cloud {
    position: absolute;
    width: 80px;
    height: 40px;
    background: 
        radial-gradient(ellipse at 30% 50%, rgba(255,255,255,0.9), transparent 70%),
        radial-gradient(ellipse at 60% 30%, rgba(255,255,255,0.8), transparent 60%),
        radial-gradient(ellipse at 80% 60%, rgba(255,255,255,0.7), transparent 50%);
    border-radius: 50px;
    animation: cloudDrift 20s linear infinite;
    transform: translateZ(-500px);
}

@keyframes cloudDrift {
    0% { transform: translateZ(-500px) translateX(-100px); }
    100% { transform: translateZ(-500px) translateX(calc(100vw + 100px)); }
}

/* Buildings */
.buildings-left, .buildings-right {
    position: absolute;
    width: 100%;
    height: 100%;
    transform-style: preserve-3d;
}

.building {
    position: absolute;
    background: linear-gradient(145deg, #4a4a4a, #2a2a2a);
    border: 1px solid #1a1a1a;
    transform-style: preserve-3d;
    box-shadow: 0 0 20px rgba(0,0,0,0.5);
}

.building::before {
    content: '';
    position: absolute;
    top: 10%;
    left: 10%;
    right: 10%;
    bottom: 10%;
    background: 
        repeating-linear-gradient(
            0deg,
            transparent 0px,
            transparent 8px,
            rgba(255,255,0,0.3) 8px,
            rgba(255,255,0,0.3) 10px
        ),
        repeating-linear-gradient(
            90deg,
            transparent 0px,
            transparent 12px,
            rgba(255,255,0,0.2) 12px,
            rgba(255,255,0,0.2) 14px
        );
    transform: translateZ(1px);
}

/* Trees */
.trees-left, .trees-right {
    position: absolute;
    width: 100%;
    height: 100%;
    transform-style: preserve-3d;
}

.tree {
    position: absolute;
    width: 20px;
    height: 60px;
    transform-style: preserve-3d;
}

.tree::before {
    content: '';
    position: absolute;
    bottom: 0;
    left: 35%;
    width: 30%;
    height: 40%;
    background: linear-gradient(to bottom, #8B4513, #654321);
    border-radius: 0 0 3px 3px;
    transform: translateZ(1px);
}

.tree::after {
    content: '';
    position: absolute;
    top: 0;
    left: 10%;
    width: 80%;
    height: 70%;
    background: 
        radial-gradient(ellipse at 50% 80%, #228B22, #006400),
        radial-gradient(ellipse at 30% 40%, rgba(144,238,144,0.8), transparent 60%);
    border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
    transform: translateZ(2px);
}

/* Mountains */
.mountains {
    position: absolute;
    width: 100%;
    height: 50%;
    top: 0;
    background: 
        linear-gradient(to bottom, transparent 0%, transparent 60%, rgba(139,69,19,0.3) 60%, rgba(101,67,33,0.5) 100%),
        conic-gradient(from 0deg at 20% 100%, transparent 0deg, rgba(105,105,105,0.4) 45deg, rgba(169,169,169,0.6) 90deg, rgba(105,105,105,0.4) 135deg, transparent 180deg),
        conic-gradient(from 0deg at 60% 100%, transparent 0deg, rgba(105,105,105,0.3) 30deg, rgba(169,169,169,0.5) 60deg, rgba(105,105,105,0.3) 90deg, transparent 120deg),
        conic-gradient(from 0deg at 80% 100%, transparent 0deg, rgba(105,105,105,0.4) 60deg, rgba(169,169,169,0.6) 120deg, rgba(105,105,105,0.4) 180deg, transparent 240deg);
    transform: translateZ(-800px) scale(1.5);
    pointer-events: none;
}

/* Lane Markers */
.lane-markers {
    position: absolute;
    width: 100%;
    height: 100%;
    transform-style: preserve-3d;
    z-index: 45;
}

.lane-marker {
    position: absolute;
    width: 4px;
    height: 30px;
    background: linear-gradient(to bottom, #fff, rgba(255,255,255,0.5));
    left: 50%;
    transform: translateX(-50%);
    border-radius: 2px;
    box-shadow: 0 0 5px rgba(255,255,255,0.5);
    animation: laneMove 0.2s linear infinite;
}

@keyframes laneMove {
    0% { transform: translateX(-50%) translateZ(0px); }
    100% { transform: translateX(-50%) translateZ(200px); }
}

/* ==============================================
   ENHANCED PLAYER CAR
   ============================================== */

.car-exhaust-left, .car-exhaust-right {
    position: absolute;
    width: 6px;
    height: 8px;
    bottom: 5%;
    background: radial-gradient(circle, rgba(255,69,0,0.8), rgba(255,140,0,0.4));
    border-radius: 50%;
    transform: translateZ(1px);
    animation: exhaustGlow 0.5s ease-in-out infinite alternate;
}

.car-exhaust-left { left: 20%; }
.car-exhaust-right { right: 20%; }

@keyframes exhaustGlow {
    0% { box-shadow: 0 0 5px rgba(255,69,0,0.6); }
    100% { box-shadow: 0 0 15px rgba(255,69,0,1), 0 0 25px rgba(255,140,0,0.8); }
}

.car-headlights {
    position: absolute;
    top: 8%;
    left: 15%;
    right: 15%;
    height: 8px;
    background: 
        linear-gradient(90deg, transparent 0%, rgba(255,255,255,0.9) 20%, rgba(255,255,255,0.9) 80%, transparent 100%),
        radial-gradient(ellipse at 25% 50%, rgba(173,216,230,0.8), transparent 60%),
        radial-gradient(ellipse at 75% 50%, rgba(173,216,230,0.8), transparent 60%);
    border-radius: 10px;
    transform: translateZ(6px);
    box-shadow: 0 0 20px rgba(255,255,255,0.6);
}

.boost-trail {
    position: absolute;
    bottom: -20px;
    left: 50%;
    width: 80%;
    height: 100px;
    transform: translateX(-50%) translateZ(-5px);
    background: 
        linear-gradient(to bottom, 
            rgba(0,255,255,0.8) 0%, 
            rgba(0,191,255,0.6) 20%, 
            rgba(135,206,250,0.4) 50%, 
            transparent 100%);
    border-radius: 50%;
    opacity: 0;
    filter: blur(3px);
    animation: boostTrailPulse 0.3s ease-in-out infinite;
}

@keyframes boostTrailPulse {
    0% { transform: translateX(-50%) translateZ(-5px) scale(0.8); }
    100% { transform: translateX(-50%) translateZ(-5px) scale(1.2); }
}

.boost-trail.active {
    opacity: 1;
}

.shield-effect {
    position: absolute;
    top: -10%;
    left: -10%;
    right: -10%;
    bottom: -10%;
    border: 3px solid rgba(0,255,255,0.6);
    border-radius: 50%;
    opacity: 0;
    transform: translateZ(10px);
    animation: shieldPulse 1s ease-in-out infinite;
    box-shadow: 
        0 0 20px rgba(0,255,255,0.8),
        inset 0 0 20px rgba(0,255,255,0.3);
}

@keyframes shieldPulse {
    0% { transform: translateZ(10px) scale(1); opacity: 0.8; }
    50% { transform: translateZ(10px) scale(1.1); opacity: 1; }
    100% { transform: translateZ(10px) scale(1); opacity: 0.8; }
}

.shield-effect.active {
    opacity: 1;
}

/* ==============================================
   POWER-UPS
   ============================================== */

.powerup {
    position: absolute;
    width: 40px;
    height: 40px;
    transform-style: preserve-3d;
    z-index: 60;
    animation: powerupFloat 2s ease-in-out infinite, powerupSpin 4s linear infinite;
}

.powerup-speed {
    background: 
        radial-gradient(circle, #FFD700, #FFA500),
        conic-gradient(from 0deg, #FFD700, #FF8C00, #FFD700);
    border: 3px solid #FF8C00;
    border-radius: 50%;
    box-shadow: 
        0 0 20px rgba(255,215,0,0.8),
        0 5px 15px rgba(0,0,0,0.4);
}

.powerup-speed::before {
    content: '⚡';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%) translateZ(2px);
    font-size: 20px;
    text-shadow: 0 0 10px rgba(255,255,255,0.8);
}

.powerup-shield {
    background: 
        radial-gradient(circle, #00FFFF, #0080FF),
        conic-gradient(from 0deg, #00FFFF, #0040FF, #00FFFF);
    border: 3px solid #0080FF;
    border-radius: 50%;
    box-shadow: 
        0 0 20px rgba(0,255,255,0.8),
        0 5px 15px rgba(0,0,0,0.4);
}

.powerup-shield::before {
    content: '🛡️';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%) translateZ(2px);
    font-size: 18px;
}

.powerup-coin {
    background: 
        radial-gradient(circle, #FFD700, #B8860B),
        conic-gradient(from 0deg, #FFD700, #DAA520, #FFD700);
    border: 3px solid #B8860B;
    border-radius: 50%;
    box-shadow: 
        0 0 15px rgba(255,215,0,0.6),
        0 3px 10px rgba(0,0,0,0.3);
}

.powerup-coin::before {
    content: '🪙';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%) translateZ(2px);
    font-size: 18px;
}

.powerup-multiplier {
    background: 
        radial-gradient(circle, #FF69B4, #FF1493),
        conic-gradient(from 0deg, #FF69B4, #DC143C, #FF69B4);
    border: 3px solid #FF1493;
    border-radius: 50%;
    box-shadow: 
        0 0 20px rgba(255,105,180,0.8),
        0 5px 15px rgba(0,0,0,0.4);
}

.powerup-multiplier::before {
    content: '✨';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%) translateZ(2px);
    font-size: 18px;
}

@keyframes powerupFloat {
    0% { transform: translateY(0px) translateZ(0px); }
    50% { transform: translateY(-10px) translateZ(5px); }
    100% { transform: translateY(0px) translateZ(0px); }
}

@keyframes powerupSpin {
    0% { transform: rotateY(0deg); }
    100% { transform: rotateY(360deg); }
}

/* ==============================================
   ENHANCED OBSTACLES
   ============================================== */

.obstacle-motorcycle {
    width: 35px;
    height: 80px;
    background: 
        linear-gradient(145deg, #FF4500, #FF6347),
        radial-gradient(ellipse at 30% 30%, rgba(255,255,255,0.3), transparent 60%);
    border-radius: 20% 20% 40% 40%;
    border: 2px solid #CD5C5C;
    box-shadow: 
        0 6px 18px rgba(0,0,0,0.5),
        0 3px 8px rgba(0,0,0,0.3),
        inset 0 2px 5px rgba(255,255,255,0.2);
    transform: translateZ(1px);
    position: relative;
}

.obstacle-motorcycle::before {
    content: '';
    position: absolute;
    top: 20%;
    left: 25%;
    right: 25%;
    height: 20%;
    background: linear-gradient(145deg, rgba(0,0,0,0.8), rgba(64,64,64,0.6));
    border-radius: 15px;
    transform: translateZ(2px);
}

.obstacle-barrier {
    width: 80px;
    height: 40px;
    background: 
        repeating-linear-gradient(
            45deg,
            #FF0000 0px,
            #FF0000 10px,
            #FFFFFF 10px,
            #FFFFFF 20px
        );
    border: 3px solid #8B0000;
    border-radius: 5px;
    box-shadow: 
        0 5px 15px rgba(0,0,0,0.6),
        0 2px 8px rgba(0,0,0,0.4);
    transform: translateZ(2px);
    position: relative;
}

.obstacle-oil {
    width: 60px;
    height: 60px;
    background: 
        radial-gradient(ellipse at 40% 30%, rgba(0,0,0,0.8), rgba(64,64,64,0.6)),
        radial-gradient(ellipse at 60% 70%, rgba(128,128,128,0.4), transparent);
    border-radius: 50%;
    border: 2px solid #2F4F4F;
    box-shadow: 
        0 2px 10px rgba(0,0,0,0.6),
        inset 0 2px 5px rgba(255,255,255,0.1);
    transform: translateZ(0px);
    animation: oilShimmer 3s ease-in-out infinite;
}

@keyframes oilShimmer {
    0% { filter: hue-rotate(0deg); }
    50% { filter: hue-rotate(180deg); }
    100% { filter: hue-rotate(360deg); }
}

.obstacle-ramp {
    width: 70px;
    height: 30px;
    background: 
        linear-gradient(145deg, #708090, #2F4F4F),
        linear-gradient(to right, rgba(255,255,255,0.2) 0%, transparent 50%);
    border: 2px solid #1C1C1C;
    border-radius: 5px 5px 0 0;
    box-shadow: 
        0 4px 12px rgba(0,0,0,0.5),
        inset 0 2px 5px rgba(255,255,255,0.2);
    transform: translateZ(1px) perspective(100px) rotateX(15deg);
    position: relative;
}

/* ==============================================
   ENHANCED EFFECTS
   ============================================== */

.explosion-effect {
    position: absolute;
    width: 100px;
    height: 100px;
    background: 
        radial-gradient(circle, rgba(255,69,0,0.9) 0%, rgba(255,140,0,0.7) 30%, rgba(255,215,0,0.5) 60%, transparent 100%);
    border-radius: 50%;
    opacity: 0;
    transform: scale(0);
    z-index: 200;
    pointer-events: none;
}

.explosion-effect.active {
    animation: explode 0.6s ease-out forwards;
}

@keyframes explode {
    0% {
        opacity: 1;
        transform: scale(0);
        filter: brightness(2);
    }
    50% {
        opacity: 1;
        transform: scale(1.5);
        filter: brightness(1.5);
    }
    100% {
        opacity: 0;
        transform: scale(3);
        filter: brightness(0.5);
    }
}

.screen-shake {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 150;
}

.screen-shake.active {
    animation: shake 0.5s ease-in-out;
}

@keyframes shake {
    0% { transform: translate(0); }
    10% { transform: translate(-2px, -1px); }
    20% { transform: translate(2px, 1px); }
    30% { transform: translate(-1px, 2px); }
    40% { transform: translate(1px, -2px); }
    50% { transform: translate(-2px, 1px); }
    60% { transform: translate(2px, -1px); }
    70% { transform: translate(-1px, -2px); }
    80% { transform: translate(1px, 2px); }
    90% { transform: translate(-2px, -1px); }
    100% { transform: translate(0); }
}

/* ==============================================
   ENHANCED UI
   ============================================== */

.mini-map {
    position: absolute;
    top: 20px;
    right: 20px;
    width: 120px;
    height: 150px;
    background: rgba(0,0,0,0.8);
    border: 2px solid rgba(255,255,255,0.3);
    border-radius: 10px;
    backdrop-filter: blur(10px);
    pointer-events: auto;
    z-index: 1001;
    transform-style: preserve-3d;
}

.mini-car {
    position: absolute;
    bottom: 20px;
    left: 50%;
    width: 8px;
    height: 12px;
    background: #ff6b6b;
    border-radius: 40% 40% 10% 10%;
    transform: translateX(-50%);
    border: 1px solid #fff;
}

.mini-obstacle {
    position: absolute;
    width: 6px;
    height: 8px;
    background: #2196F3;
    border-radius: 2px;
    border: 1px solid rgba(255,255,255,0.5);
}

.power-up-bar {
    position: absolute;
    top: 20px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    gap: 10px;
    pointer-events: auto;
    z-index: 1001;
}

.active-powerup {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
    border: 3px solid rgba(255,255,255,0.5);
    backdrop-filter: blur(10px);
    position: relative;
    animation: powerupPulse 1s ease-in-out infinite;
}

.active-powerup::after {
    content: '';
    position: absolute;
    top: -3px;
    left: -3px;
    right: -3px;
    bottom: -3px;
    border-radius: 50%;
    border: 2px solid currentColor;
    animation: powerupTimer 5s linear forwards;
}

@keyframes powerupTimer {
    0% { 
        clip-path: polygon(50% 0%, 100% 0%, 100% 100%, 50% 100%, 0% 100%, 0% 0%);
    }
    100% { 
        clip-path: polygon(50% 0%, 50% 0%, 50% 100%, 50% 100%, 50% 100%, 50% 0%);
    }
}

.achievement-popup {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%) scale(0);
    background: rgba(0,0,0,0.9);
    color: #FFD700;
    padding: 20px;
    border-radius: 15px;
    border: 2px solid #FFD700;
    backdrop-filter: blur(20px);
    text-align: center;
    z-index: 1500;
    pointer-events: none;
    box-shadow: 0 10px 30px rgba(255,215,0,0.3);
}

.achievement-popup.show {
    animation: achievementShow 3s ease-in-out;
}

@keyframes achievementShow {
    0% { transform: translate(-50%, -50%) scale(0); opacity: 0; }
    15% { transform: translate(-50%, -50%) scale(1.1); opacity: 1; }
    20% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
    80% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
    100% { transform: translate(-50%, -50%) scale(0); opacity: 0; }
}

.achievement-icon {
    font-size: 40px;
    margin-bottom: 10px;
    animation: bounce 0.6s ease-in-out infinite alternate;
}

@keyframes bounce {
    0% { transform: translateY(0); }
    100% { transform: translateY(-10px); }
}

.settings-screen {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: rgba(0,0,0,0.95);
    color: white;
    padding: 40px;
    border-radius: 20px;
    backdrop-filter: blur(20px);
    border: 2px solid rgba(255,255,255,0.2);
    text-align: center;
    pointer-events: auto;
    z-index: 1200;
}

.setting-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin: 20px 0;
    padding: 10px;
    background: rgba(255,255,255,0.1);
    border-radius: 10px;
}

.setting-item label {
    font-size: 1.1em;
}

.setting-item input, .setting-item select {
    background: rgba(255,255,255,0.2);
    border: 1px solid rgba(255,255,255,0.3);
    color: white;
    padding: 5px 10px;
    border-radius: 5px;
}

/* Enhanced score panel */
.score-panel {
    background: 
        linear-gradient(145deg, rgba(0,0,0,0.8), rgba(0,0,0,0.6)),
        radial-gradient(ellipse at top left, rgba(255,107,107,0.1), transparent 70%);
    border: 2px solid rgba(255,107,107,0.3);
    box-shadow: 
        0 10px 30px rgba(0,0,0,0.5),
        inset 0 2px 10px rgba(255,255,255,0.1);
}

/* Responsive enhancements */
@media (max-width: 768px) {
    .mini-map {
        width: 80px;
        height: 100px;
        top: 10px;
        right: 10px;
    }
    
    .power-up-bar {
        top: 10px;
        gap: 5px;
    }
    
    .active-powerup {
        width: 35px;
        height: 35px;
        font-size: 16px;
    }
    
    .achievement-popup {
        padding: 15px;
        margin: 0 20px;
        max-width: calc(100vw - 40px);
    }
    
    .settings-screen {
        padding: 20px;
        margin: 0 10px;
        max-width: calc(100vw - 20px);
    }
}
